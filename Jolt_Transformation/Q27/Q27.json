Input

[
    {
      "returnId": "10051",
      "returnQuantity": 2,
      "returnPrice": 100,
      "returnTax": 12.56,
      "country": "USA"
    },
    {
      "returnId": "10052",
      "returnQuantity": 25,
      "returnPrice": 35,
      "returnTax": 29.85,
      "country": "CA"
    },
    {
      "returnId": "10053",
      "returnQuantity": 5,
      "returnPrice": 55,
      "returnTax": 9.85,
      "country": ""
    }
  ]


  Jolt Spec

  [
    {
      "operation": "shift",
      "spec": {
        "*": {
          "@": "@(1,returnId)"
        }
      }
    },
    {
      "operation": "modify-overwrite-beta",
      "spec": {
        "10051": {
          "country": "United States of America"
        },
        "10052": {
          "country": "Canada"
        },
        "10053": {
          "country": "NA"
        },
        "*": {
          "inverseValue": "=divide(1, @(1,returnQuantity))",
          "Return Amount": "=divideAndRound(2, @(1,returnPrice), @(1,inverseValue))",
          "Return Total Amount": "=doubleSum(@(1,returnTax),@(1,Return Amount))"
        }
      }
    },
  
    {
      "operation": "remove",
      "spec": {
        "*": {
          "inverseValue": "",
          "returnQuantity": "",
          "returnPrice": "",
          "returnTax": ""
        }
      }
    },
    {
      "operation": "shift",
      "spec": {
        "*": {
          "*": "[#2].&"
        }
      }
    }
  ]


  Output

  [ {
    "returnId" : "10051",
    "country" : "United States of America",
    "Return Amount" : 200.0,
    "Return Total Amount" : 212.56
  }, {
    "returnId" : "10052",
    "country" : "Canada",
    "Return Amount" : 875.0,
    "Return Total Amount" : 904.85
  }, {
    "returnId" : "10053",
    "country" : "NA",
    "Return Amount" : 275.0,
    "Return Total Amount" : 284.85
  } ]
  