Input Json
{
  "employees": [
    {
      "id": "1001",
      "name": "John Doe",
      "age": 25,
      "skills": [
        {
          "name": "Java",
          "level": "Intermediate"
        },
        {
          "name": "Python",
          "level": "Expert"
        }
      ]
    },
    {
      "id": "1002",
      "name": "Jane Doe",
      "age": 30,
      "skills": [
        {
          "name": "Java",
          "level": "Expert"
        }
      ]
    }
  ]
}

Output Json
{
  "Java": {
    "Intermediate": [
      "John Doe"
    ],
    "Expert": [
      "Jane Doe",
      "John Doe"
    ]
  },
  "Python": {
    "Expert": [
      "John Doe"
    ]
  }
}

Jolt Spec
[
  {
    "operation": "shift",
    "spec": {
      "employees": {
        "*": {
          "skills": {
            "*": {
              "": "@(1,name).@(1,level).[]",
              "@(2,name)": "@(1,name).@(1,level).[]"
            }
          }
        }
      }
    }
  }
 ]
