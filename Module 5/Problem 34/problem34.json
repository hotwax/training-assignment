Input:

{
  "name": "John",
  "hobby_1": "reading",
  "level_1": "advanced",
  "hobby_2": "swimming",
  "level_2": "beginner"
}

Transformation:

[
  {
    "operation": "shift",
    "spec": {
      "name": "name",
      "hobby_*": "hobbies[#2].&(0,1).name",
      "level_*": "hobbies[#2].&(0,1).level"
    }
  }
,
  {
    "operation": "shift",
    "spec": {
      "name": "name",
      "hobbies": {
        "*": {
          "*": {
            "name": "hobbies[#2].name",
            "level": "hobbies[#2].level"
          }
        }
      }
    }
  }
]

Output:

{
  "name" : "John",
  "hobbies" : [ {
    "name" : "reading",
    "level" : "advanced"
  }, {
    "name" : "swimming",
    "level" : "beginner"
  } ]
}